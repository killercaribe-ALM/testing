<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_almus_partner_confidential_res_config_settings" model="ir.ui.view">
        <field name="name">almus.partner_confidential.res.config.settings.form</field>
        <field name="model">res.config.settings</field>
        <field name="inherit_id" ref="almus_base.view_almus_base_res_config_settings"/>
        <field name="arch" type="xml">
            <xpath expr="//block[@name='almus_app_settings']" position="inside">
                <setting id="almus_partner_confidential_settings" 
                         string="Información Confidencial de Contactos"
                         help="Gestiona el acceso a información sensible de proveedores y contactos">
                    <div class="content-group">
                        <!-- Activación del módulo -->
                        <div class="row mt16">
                            <label for="almus_partner_confidential_enabled" class="col-lg-3 o_light_label"/>
                            <field name="almus_partner_confidential_enabled"/>
                        </div>
                        
                        <!-- Panel de estadísticas -->
                        <div class="row mt16">
                            <div class="col-md-6">
                                <div class="o_setting_box">
                                    <div class="o_setting_box_title">
                                        <strong>Estadísticas de Uso</strong>
                                    </div>
                                    <div class="text-muted mt-2">
                                        <i class="fa fa-users"/> Usuarios con acceso: 
                                        <field name="almus_total_confidential_users" class="oe_inline fw-bold"/>
                                    </div>
                                    <div class="text-muted">
                                        <i class="fa fa-address-card"/> Contactos con info. confidencial: 
                                        <field name="almus_partners_with_confidential" class="oe_inline fw-bold"/>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="o_setting_box">
                                    <div class="o_setting_box_title">
                                        <strong>Gestión de Accesos</strong>
                                    </div>
                                    <div class="mt-2">
                                        <button name="action_view_confidential_users" 
                                                type="object" 
                                                string="Ver Usuarios con Acceso" 
                                                class="btn-link"
                                                icon="fa-users"/>
                                    </div>
                                    <div class="mt-2">
                                        <button name="action_view_confidential_partners" 
                                                type="object" 
                                                string="Ver Contactos Confidenciales" 
                                                class="btn-link"
                                                icon="fa-address-card"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Información sobre la funcionalidad -->
                        <div class="row mt16">
                            <div class="col-12">
                                <div class="alert alert-info" role="alert">
                                    <h4 class="alert-heading">
                                        <i class="fa fa-shield"/> Información Confidencial Protegida
                                    </h4>
                                    <p>
                                        Este módulo agrega una pestaña "Información Confidencial" en el formulario de contactos
                                        que solo es visible para usuarios con el permiso correspondiente.
                                    </p>
                                    <hr/>
                                    <p class="mb-0">
                                        <strong>Campos protegidos:</strong> Nombre internacional, WeChat ID, WhatsApp, 
                                        términos de pago, condiciones de precios, información bancaria y notas internas.
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Instrucciones para administradores -->
                        <div class="row mt16">
                            <div class="col-12">
                                <div class="o_setting_box">
                                    <div class="o_setting_box_title">
                                        <strong>¿Cómo otorgar acceso?</strong>
                                    </div>
                                    <div class="text-muted">
                                        <ol class="mb-0">
                                            <li>Ir a Configuración → Usuarios y Compañías → Usuarios</li>
                                            <li>Seleccionar el usuario deseado</li>
                                            <li>En la pestaña "Permisos de Acceso"</li>
                                            <li>En la sección "Información Confidencial de Contactos"</li>
                                            <li>Marcar "Ver Información Confidencial"</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </setting>
            </xpath>
        </field>
    </record>
</odoo>